{% extends "layout.html" %}
{% block title %}Управление редакторами{% endblock %}

{% block content %}
<div class="py-12 max-w-6xl mx-auto">
    <div class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-4xl font-bold">Управление редакторами</h1>
            <p class="text-slate-400 mt-2">Изменение статуса и просмотр активности участников Совета Редакторов.</p>
        </div>
        <a href="{{ url_for('bot_portal.dashboard') }}" class="text-indigo-400 hover:underline text-sm">&larr; Назад в панель</a>
    </div>

    <div class="bg-slate-800/50 border border-slate-700 rounded-lg shadow-lg overflow-x-auto">
        <table class="min-w-full">
            <thead class="bg-slate-800">
            <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">Редактор</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">Статус</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">Управление статусом</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">Действия</th>
            </tr>
            </thead>
            <tbody class="divide-y divide-slate-700">
            {% for editor in editors %}
            <tr id="editor-row-{{ editor.user_id }}">
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    <div class="font-semibold text-slate-200">{{ editor.first_name }}</div>
                    <div class="text-slate-400">@{{ editor.username or 'N/A' }}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    {% if editor.is_inactive %}
                    <span class="status-text px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-500/20 text-yellow-300">В СНС</span>
                    {% else %}
                    <span class="status-text px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-500/20 text-green-300">Активен</span>
                    {% endif %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    {% if editor.user_id != user.user_id %}
                    <button class="status-toggle-btn bg-slate-700 hover:bg-slate-600 text-white font-semibold py-2 px-4 rounded-lg transition text-xs"
                            data-user-id="{{ editor.user_id }}"
                            data-is-inactive="{{ editor.is_inactive|string|lower }}">
                        {% if editor.is_inactive %}
                        Сделать активным
                        {% else %}
                        Отправить в СНС
                        {% endif %}
                    </button>
                    {% else %}
                    <span class="text-xs text-slate-500 italic">Это вы</span>
                    {% endif %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    <a href="{{ url_for('bot_portal.editor_activity', user_id=editor.user_id) }}" class="text-indigo-400 hover:underline text-xs">
                        Посмотреть активность &rarr;
                    </a>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block body_js %}
<script src="{{ url_for('static', filename='js/editor_management.js') }}"></script>
{% endblock %}